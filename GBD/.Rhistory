filter(location %in% c("Argentina",
"Bolivia",
"Brazil",
"Chile",
"Colombia",
"Ecuador",
"Guyana",
"Paraguay",
"Peru",
"Suriname",
"Uruguay",
"Venezuela")) %>%
mutate(age = recode(age,  "Under 5"="<5 years",                                                              "5 to 9"="5-9 years",
"10 to 14"="10-14 years",
"15 to 19"="15-19 years",
"20 to 24"="20-24 years",
"25 to 29"="25-29 years",
"30 to 34"="30-34 years",
"35 to 39"="35-39 years",
"40 to 44"="40-44 years",
"45 to 49"="45-49 years",
"50 to 54"="50-54 years",
"55 to 59"="55-59 years",
"60 to 64"="60-64 years",
"65 to 69"="65-69 years",
"70 to 74"="70-74 years",
"75 to 79"="75-79 years",
"80 to 84"="80-84 years",
"85 to 89"="85-89 years",
"90 to 94"="90-94 years",
"95 plus"="95+ years",
"All Ages" = "All ages")) %>%
filter(age %in% c("<5 years",                                                                        "5-9 years",
"10-14 years",
"15-19 years",
"20-24 years",
"25-29 years",
"30-34 years",
"35-39 years",
"40-44 years",
"45-49 years",
"50-54 years",
"55-59 years",
"60-64 years",
"65-69 years",
"70-74 years",
"75-79 years",
"80-84 years",
"85-89 years",
"90-94 years",
"95+ years",
"All ages"))
rm(GBD_POP_1990,GBD_POP_2019)
SDI <- SDI %>%
filter(Location %in% c("Argentina",
"Bolivia",
"Brazil",
"Chile",
"Colombia",
"Ecuador",
"Guyana",
"Paraguay",
"Peru",
"Suriname",
"Uruguay",
"Venezuela")) %>%
select("Location", "1990", "2019") %>%
pivot_longer(cols = c("1990", "2019"),
names_to = "year",
values_to = "SDI")
GBDrates <- GBDrates %>%
mutate(measure = recode(measure,
"YLDs (Years Lived with Disability)" = "YLDs",
"YLLs (Years of Life Lost)" = "YLLs",
"DALYs (Disability-Adjusted Life Years)" = "DALYs")) %>%
mutate(location = recode(location,
"Bolivia (Plurinational State of)" = "Bolivia",
"Venezuela (Bolivarian Republic of)" = "Venezuela")) %>%
mutate(year_end = as.factor(year_end)) %>%
select(-c("rei", "year_start")) %>%
rename(ROC_val = val,
ROC_upper = upper,
ROC_lower = lower,
year = year_end)
SA_map <- ne_countries(scale = "medium",
type = "map_units",
returnclass = "sf") %>%
filter(name %in% c("Argentina",
"Bolivia",
"Brazil",
"Chile",
"Colombia",
"Ecuador",
"Guyana",
"Paraguay",
"Peru",
"Suriname",
"Uruguay",
"Venezuela"))
GBD <- GBD %>%
full_join(SDI, by = c("location" = "Location", "year" = "year")) %>%
full_join(GBD_POP, by=c("location"="location",
"age"="age",
"sex"="sex",
"year"="year")) %>%
full_join(GBDrates, by = c("location" = "location",
"measure" = "measure",
"sex" = "sex",
"cause" = "cause",
"metric" = "metric",
"year" = "year_end",
"age" = "age"))
library(ggplot2)
library(ggthemes)
library(plotly)
library(tidyverse)
library(readr)
library(here)
# library(maps)
# library(ggmap)
# library(maptools)
library(rnaturalearth)
library(rnaturalearthdata)
library(rnaturalearthhires)
library(hrbrthemes)
library(shadowtext)
GBD <- readr::read_csv(file = here::here("GBD_vals.csv"))
GBD_2 <- readr::read_csv(file= here::here("GBD_2.csv"))
GBDrates <- readr::read_csv(file = here::here("GBD_ROC.csv"))
SDI <- readr::read_csv(file = here::here("GBD_SDI_1990_2019.csv"))
GBD_POP_2019 <- read_csv(file = here::here("GBD_POP_2019.CSV"))
GBD_POP_1990 <- read_csv(file = here::here("GBD_POP_1990.CSV"))
GBD <- GBD %>%
bind_rows(GBD_2)
rm(GBD_2)
GBD <- GBD %>%
mutate(age = recode(age, "80-84" = "80-84 years",
"85-89" = "85-89 years",
"90-94" = "90-94 years"),
year = as.factor(year))%>%
mutate(age = as.factor(age#, levels = c("<5 years",                                                                        "5-9 years",
#             "10-14 years",
#            "15-19 years",
#           "20-24 years",
#          "25-29 years",
#         "30-34 years",
#        "35-39 years",
#       "40-44 years",
#      "45-49 years",
#     "50-54 years",
#    "55-59 years",
#   "60-64 years",
#  "65-69 years",
# "70-74 years",
#            "75-79 years",
#           "80-84 years",
#          "85-89 years",
#         "90-94 years",
#        "95+ years",
#       "All ages",
#      "Age-standardized")
)) %>%
mutate(measure = recode(measure,
"YLDs (Years Lived with Disability)" = "YLDs",
"YLLs (Years of Life Lost)" = "YLLs",
"DALYs (Disability-Adjusted Life Years)" = "DALYs"),
location = recode(location,
"Bolivia (Plurinational State of)" = "Bolivia",
"Venezuela (Bolivarian Republic of)" = "Venezuela"),
val_cat = cut(x = GBD$val,
breaks = c(-Inf, 1, 10, 100, 500,
1000, 2500, 5000, Inf),
labels = c("0 - 1",
"1 - 10",
"10 - 100",
"100 - 500",
"500 - 1000",
"1000 - 2500",
"2500 - 5000",
">5000")))
GBD_POP <-  GBD_POP_1990 %>%
bind_rows(GBD_POP_2019) %>%
rename(location = location_name,
sex = sex_name,
age = age_group_name,
year = year_id,
pop = val) %>%
select(location, sex, age, year, pop) %>%
mutate(location = recode(location,
"Bolivia (Plurinational State of)" = "Bolivia",
"Venezuela (Bolivarian Republic of)" = "Venezuela"),
sex = recode(sex,
"both" = "Both",
"male" = "Male",
"female" = "Female"),
age = as.factor(age),
year = as.factor(year))%>%
filter(location %in% c("Argentina",
"Bolivia",
"Brazil",
"Chile",
"Colombia",
"Ecuador",
"Guyana",
"Paraguay",
"Peru",
"Suriname",
"Uruguay",
"Venezuela")) %>%
mutate(age = recode(age,  "Under 5"="<5 years",                                                              "5 to 9"="5-9 years",
"10 to 14"="10-14 years",
"15 to 19"="15-19 years",
"20 to 24"="20-24 years",
"25 to 29"="25-29 years",
"30 to 34"="30-34 years",
"35 to 39"="35-39 years",
"40 to 44"="40-44 years",
"45 to 49"="45-49 years",
"50 to 54"="50-54 years",
"55 to 59"="55-59 years",
"60 to 64"="60-64 years",
"65 to 69"="65-69 years",
"70 to 74"="70-74 years",
"75 to 79"="75-79 years",
"80 to 84"="80-84 years",
"85 to 89"="85-89 years",
"90 to 94"="90-94 years",
"95 plus"="95+ years",
"All Ages" = "All ages")) %>%
filter(age %in% c("<5 years",                                                                        "5-9 years",
"10-14 years",
"15-19 years",
"20-24 years",
"25-29 years",
"30-34 years",
"35-39 years",
"40-44 years",
"45-49 years",
"50-54 years",
"55-59 years",
"60-64 years",
"65-69 years",
"70-74 years",
"75-79 years",
"80-84 years",
"85-89 years",
"90-94 years",
"95+ years",
"All ages"))
rm(GBD_POP_1990,GBD_POP_2019)
SDI <- SDI %>%
filter(Location %in% c("Argentina",
"Bolivia",
"Brazil",
"Chile",
"Colombia",
"Ecuador",
"Guyana",
"Paraguay",
"Peru",
"Suriname",
"Uruguay",
"Venezuela")) %>%
select("Location", "1990", "2019") %>%
pivot_longer(cols = c("1990", "2019"),
names_to = "year",
values_to = "SDI")
GBDrates <- GBDrates %>%
mutate(measure = recode(measure,
"YLDs (Years Lived with Disability)" = "YLDs",
"YLLs (Years of Life Lost)" = "YLLs",
"DALYs (Disability-Adjusted Life Years)" = "DALYs")) %>%
mutate(location = recode(location,
"Bolivia (Plurinational State of)" = "Bolivia",
"Venezuela (Bolivarian Republic of)" = "Venezuela")) %>%
mutate(year_end = as.factor(year_end)) %>%
select(-c("rei", "year_start")) %>%
rename(ROC_val = val,
ROC_upper = upper,
ROC_lower = lower,
year = year_end)
SA_map <- ne_countries(scale = "medium",
type = "map_units",
returnclass = "sf") %>%
filter(name %in% c("Argentina",
"Bolivia",
"Brazil",
"Chile",
"Colombia",
"Ecuador",
"Guyana",
"Paraguay",
"Peru",
"Suriname",
"Uruguay",
"Venezuela"))
GBD <- GBD %>%
full_join(SDI, by = c("location" = "Location", "year" = "year")) %>%
full_join(GBD_POP, by=c("location"="location",
"age"="age",
"sex"="sex",
"year"="year")) %>%
full_join(GBDrates, by=c("location" = "location",
"measure" = "measure",
"sex" = "sex",
"cause" = "cause",
"metric" = "metric",
"year" = "year",
"age" = "age"))
rm(GBD_POP, SDI, GBDrates)
# group_by(year, sex_name, age_group_name) %>%
# summarise(location = "South America", pop = sum(pop))
#           full_join(SA %>% select(c("admin", "sov_a3")),
#                     by = c("location" = "admin"))
#
# GBD_SA <- GBD %>%
#           filter(age == "All ages") %>%
#           group_by(measure, cause, metric, year) %>%
#           summarise(location = "South America",
#                     val = sum(val)) %>%
#           filter(metric == "Number") %>%
#           mutate(age = "All ages")%>%
#           inner_join(GBD_POP_all %>% select(year, pop), by = "year") %>%
#           mutate(val_rate = (val/pop)*100000)
#rm("GBDrates", "SDI") #don't wanna waste my precious RAM...
View(GBD)
GBD <- readr::read_csv(file = here::here("GBD_vals.csv"))
GBD_2 <- readr::read_csv(file= here::here("GBD_2.csv"))
GBDrates <- readr::read_csv(file = here::here("GBD_ROC.csv"))
SDI <- readr::read_csv(file = here::here("GBD_SDI_1990_2019.csv"))
GBD_POP_2019 <- read_csv(file = here::here("GBD_POP_2019.CSV"))
GBD_POP_1990 <- read_csv(file = here::here("GBD_POP_1990.CSV"))
esquisser()
GBD <- GBD %>%
bind_rows(GBD_2)
rm(GBD_2) #Dont waste my precious RAM
GBD <- GBD %>%
mutate(age = recode(age, "80-84" = "80-84 years",
"85-89" = "85-89 years",
"90-94" = "90-94 years"),
year = as.factor(year))%>%
mutate(age = as.factor(age#, levels = c("<5 years",                                                                        "5-9 years",
#             "10-14 years",
#            "15-19 years",
#           "20-24 years",
#          "25-29 years",
#         "30-34 years",
#        "35-39 years",
#       "40-44 years",
#      "45-49 years",
#     "50-54 years",
#    "55-59 years",
#   "60-64 years",
#  "65-69 years",
# "70-74 years",
#            "75-79 years",
#           "80-84 years",
#          "85-89 years",
#         "90-94 years",
#        "95+ years",
#       "All ages",
#      "Age-standardized")
)) %>%
mutate(measure = recode(measure,
"YLDs (Years Lived with Disability)" = "YLDs",
"YLLs (Years of Life Lost)" = "YLLs",
"DALYs (Disability-Adjusted Life Years)" = "DALYs"),
location = recode(location,
"Bolivia (Plurinational State of)" = "Bolivia",
"Venezuela (Bolivarian Republic of)" = "Venezuela"),
val_cat = cut(x = GBD$val,
breaks = c(-Inf, 1, 10, 100, 500,
1000, 2500, 5000, Inf),
labels = c("0 - 1",
"1 - 10",
"10 - 100",
"100 - 500",
"500 - 1000",
"1000 - 2500",
"2500 - 5000",
">5000")))
GBD_POP <-  GBD_POP_1990 %>%
bind_rows(GBD_POP_2019) %>%
rename(location = location_name,
sex = sex_name,
age = age_group_name,
year = year_id,
pop = val) %>%
select(location, sex, age, year, pop) %>%
mutate(location = recode(location,
"Bolivia (Plurinational State of)" = "Bolivia",
"Venezuela (Bolivarian Republic of)" = "Venezuela"),
sex = recode(sex,
"both" = "Both",
"male" = "Male",
"female" = "Female"),
age = as.factor(age),
year = as.factor(year))%>%
filter(location %in% c("Argentina",
"Bolivia",
"Brazil",
"Chile",
"Colombia",
"Ecuador",
"Guyana",
"Paraguay",
"Peru",
"Suriname",
"Uruguay",
"Venezuela")) %>%
mutate(age = recode(age,  "Under 5"="<5 years",                                                              "5 to 9"="5-9 years",
"10 to 14"="10-14 years",
"15 to 19"="15-19 years",
"20 to 24"="20-24 years",
"25 to 29"="25-29 years",
"30 to 34"="30-34 years",
"35 to 39"="35-39 years",
"40 to 44"="40-44 years",
"45 to 49"="45-49 years",
"50 to 54"="50-54 years",
"55 to 59"="55-59 years",
"60 to 64"="60-64 years",
"65 to 69"="65-69 years",
"70 to 74"="70-74 years",
"75 to 79"="75-79 years",
"80 to 84"="80-84 years",
"85 to 89"="85-89 years",
"90 to 94"="90-94 years",
"95 plus"="95+ years",
"All Ages" = "All ages")) %>%
filter(age %in% c("<5 years",                                                                        "5-9 years",
"10-14 years",
"15-19 years",
"20-24 years",
"25-29 years",
"30-34 years",
"35-39 years",
"40-44 years",
"45-49 years",
"50-54 years",
"55-59 years",
"60-64 years",
"65-69 years",
"70-74 years",
"75-79 years",
"80-84 years",
"85-89 years",
"90-94 years",
"95+ years",
"All ages"))
rm(GBD_POP_1990,GBD_POP_2019) #Dont waste my precious RAM
SDI <- SDI %>%
filter(Location %in% c("Argentina",
"Bolivia",
"Brazil",
"Chile",
"Colombia",
"Ecuador",
"Guyana",
"Paraguay",
"Peru",
"Suriname",
"Uruguay",
"Venezuela")) %>%
select("Location", "1990", "2019") %>%
pivot_longer(cols = c("1990", "2019"),
names_to = "year",
values_to = "SDI")
GBDrates <- GBDrates %>%
mutate(measure = recode(measure,
"YLDs (Years Lived with Disability)" = "YLDs",
"YLLs (Years of Life Lost)" = "YLLs",
"DALYs (Disability-Adjusted Life Years)" = "DALYs")) %>%
mutate(location = recode(location,
"Bolivia (Plurinational State of)" = "Bolivia",
"Venezuela (Bolivarian Republic of)" = "Venezuela")) %>%
mutate(year_end = as.factor(year_end)) %>%
select(-c("rei", "year_start")) %>%
rename(ROC_val = val,
ROC_upper = upper,
ROC_lower = lower,
year = year_end)
SA_map <- ne_countries(scale = "medium",
type = "map_units",
returnclass = "sf") %>%
filter(name %in% c("Argentina",
"Bolivia",
"Brazil",
"Chile",
"Colombia",
"Ecuador",
"Guyana",
"Paraguay",
"Peru",
"Suriname",
"Uruguay",
"Venezuela"))
GBD <- GBD %>%
full_join(SDI, by = c("location" = "Location", "year" = "year")) %>%
full_join(GBD_POP, by=c("location"="location",
"age"="age",
"sex"="sex",
"year"="year")) %>%
full_join(GBDrates, by=c("location" = "location",
"measure" = "measure",
"sex" = "sex",
"cause" = "cause",
"metric" = "metric",
"year" = "year",
"age" = "age"))
rm(GBD_POP, SDI, GBDrates) #Dont waste my precious RAM
esquisser()
